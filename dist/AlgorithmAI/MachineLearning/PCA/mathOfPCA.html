<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PCA的数学原理 | hsq</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="前端人">
    
    <link rel="preload" href="/assets/css/0.styles.3ff02ce1.css" as="style"><link rel="preload" href="/assets/js/app.a8893540.js" as="script"><link rel="preload" href="/assets/js/2.31cb5988.js" as="script"><link rel="preload" href="/assets/js/13.ab04a391.js" as="script"><link rel="prefetch" href="/assets/js/10.7985b25a.js"><link rel="prefetch" href="/assets/js/100.c6d2578a.js"><link rel="prefetch" href="/assets/js/101.46a865c9.js"><link rel="prefetch" href="/assets/js/102.6d3eff61.js"><link rel="prefetch" href="/assets/js/103.5bf737d9.js"><link rel="prefetch" href="/assets/js/104.06bac82a.js"><link rel="prefetch" href="/assets/js/105.fde943b0.js"><link rel="prefetch" href="/assets/js/106.d30a69fe.js"><link rel="prefetch" href="/assets/js/107.8b0cf7da.js"><link rel="prefetch" href="/assets/js/108.70680756.js"><link rel="prefetch" href="/assets/js/109.4b97f0b9.js"><link rel="prefetch" href="/assets/js/11.7dd08b40.js"><link rel="prefetch" href="/assets/js/110.dbc561f1.js"><link rel="prefetch" href="/assets/js/111.af889e90.js"><link rel="prefetch" href="/assets/js/112.ab7b3e55.js"><link rel="prefetch" href="/assets/js/113.d885678c.js"><link rel="prefetch" href="/assets/js/114.0c5a1b99.js"><link rel="prefetch" href="/assets/js/115.02c77625.js"><link rel="prefetch" href="/assets/js/116.d08f9c55.js"><link rel="prefetch" href="/assets/js/117.2f0103c0.js"><link rel="prefetch" href="/assets/js/118.ba7aeac6.js"><link rel="prefetch" href="/assets/js/119.3bcc4edc.js"><link rel="prefetch" href="/assets/js/12.7a276369.js"><link rel="prefetch" href="/assets/js/120.83826e25.js"><link rel="prefetch" href="/assets/js/121.463db754.js"><link rel="prefetch" href="/assets/js/122.d7e9a0f0.js"><link rel="prefetch" href="/assets/js/123.4f7601c9.js"><link rel="prefetch" href="/assets/js/124.f3262bc9.js"><link rel="prefetch" href="/assets/js/125.310e2615.js"><link rel="prefetch" href="/assets/js/126.040ac3cd.js"><link rel="prefetch" href="/assets/js/127.ca56c79c.js"><link rel="prefetch" href="/assets/js/128.51afc5a6.js"><link rel="prefetch" href="/assets/js/129.d4026189.js"><link rel="prefetch" href="/assets/js/130.547c2aaf.js"><link rel="prefetch" href="/assets/js/131.5059a21b.js"><link rel="prefetch" href="/assets/js/132.d9d70985.js"><link rel="prefetch" href="/assets/js/133.4a6d5190.js"><link rel="prefetch" href="/assets/js/134.44dc369a.js"><link rel="prefetch" href="/assets/js/135.4bdebb89.js"><link rel="prefetch" href="/assets/js/136.32135bcc.js"><link rel="prefetch" href="/assets/js/137.74df429c.js"><link rel="prefetch" href="/assets/js/138.71949954.js"><link rel="prefetch" href="/assets/js/139.bcbec413.js"><link rel="prefetch" href="/assets/js/14.1b6cff27.js"><link rel="prefetch" href="/assets/js/140.cdaa32ed.js"><link rel="prefetch" href="/assets/js/141.89ced459.js"><link rel="prefetch" href="/assets/js/142.55858394.js"><link rel="prefetch" href="/assets/js/143.49bf49a1.js"><link rel="prefetch" href="/assets/js/144.cdb1b941.js"><link rel="prefetch" href="/assets/js/145.07890619.js"><link rel="prefetch" href="/assets/js/146.09a56075.js"><link rel="prefetch" href="/assets/js/147.341eda30.js"><link rel="prefetch" href="/assets/js/148.8100be80.js"><link rel="prefetch" href="/assets/js/149.7d6d5d96.js"><link rel="prefetch" href="/assets/js/15.c42f7032.js"><link rel="prefetch" href="/assets/js/150.6b0d9609.js"><link rel="prefetch" href="/assets/js/151.36cd3119.js"><link rel="prefetch" href="/assets/js/152.7ec87c04.js"><link rel="prefetch" href="/assets/js/153.418143d5.js"><link rel="prefetch" href="/assets/js/154.c0e3455b.js"><link rel="prefetch" href="/assets/js/155.4d9c51bc.js"><link rel="prefetch" href="/assets/js/16.8fe4c4d4.js"><link rel="prefetch" href="/assets/js/17.4ae41c0a.js"><link rel="prefetch" href="/assets/js/18.66a3775d.js"><link rel="prefetch" href="/assets/js/19.a4ec841f.js"><link rel="prefetch" href="/assets/js/20.eae7fe18.js"><link rel="prefetch" href="/assets/js/21.c9b847dd.js"><link rel="prefetch" href="/assets/js/22.504d193b.js"><link rel="prefetch" href="/assets/js/23.16d710d1.js"><link rel="prefetch" href="/assets/js/24.ba4ff14b.js"><link rel="prefetch" href="/assets/js/25.c9b301a8.js"><link rel="prefetch" href="/assets/js/26.a65f2f89.js"><link rel="prefetch" href="/assets/js/27.4a919713.js"><link rel="prefetch" href="/assets/js/28.a38a21c0.js"><link rel="prefetch" href="/assets/js/29.13267133.js"><link rel="prefetch" href="/assets/js/3.275ff685.js"><link rel="prefetch" href="/assets/js/30.76cb66af.js"><link rel="prefetch" href="/assets/js/31.c8abafe9.js"><link rel="prefetch" href="/assets/js/32.6407664d.js"><link rel="prefetch" href="/assets/js/33.29271ce1.js"><link rel="prefetch" href="/assets/js/34.e3841dfb.js"><link rel="prefetch" href="/assets/js/35.edbfc506.js"><link rel="prefetch" href="/assets/js/36.12225931.js"><link rel="prefetch" href="/assets/js/37.6c71569b.js"><link rel="prefetch" href="/assets/js/38.11fa2e80.js"><link rel="prefetch" href="/assets/js/39.94b11484.js"><link rel="prefetch" href="/assets/js/4.71486cd2.js"><link rel="prefetch" href="/assets/js/40.75dda7e5.js"><link rel="prefetch" href="/assets/js/41.96c2735e.js"><link rel="prefetch" href="/assets/js/42.391f0d1a.js"><link rel="prefetch" href="/assets/js/43.69569c8f.js"><link rel="prefetch" href="/assets/js/44.7a63a664.js"><link rel="prefetch" href="/assets/js/45.d47dff1d.js"><link rel="prefetch" href="/assets/js/46.0dea1468.js"><link rel="prefetch" href="/assets/js/47.0b4fb0f7.js"><link rel="prefetch" href="/assets/js/48.519fead3.js"><link rel="prefetch" href="/assets/js/49.7adb4df9.js"><link rel="prefetch" href="/assets/js/5.06e63b78.js"><link rel="prefetch" href="/assets/js/50.54f55eb1.js"><link rel="prefetch" href="/assets/js/51.a01f4c59.js"><link rel="prefetch" href="/assets/js/52.26894f7c.js"><link rel="prefetch" href="/assets/js/53.f5c444ad.js"><link rel="prefetch" href="/assets/js/54.af1b76de.js"><link rel="prefetch" href="/assets/js/55.0bffc627.js"><link rel="prefetch" href="/assets/js/56.53eb6818.js"><link rel="prefetch" href="/assets/js/57.905100e6.js"><link rel="prefetch" href="/assets/js/58.ead7d42f.js"><link rel="prefetch" href="/assets/js/59.d3398af7.js"><link rel="prefetch" href="/assets/js/6.0f34a4f5.js"><link rel="prefetch" href="/assets/js/60.95fac9bb.js"><link rel="prefetch" href="/assets/js/61.e2aa2997.js"><link rel="prefetch" href="/assets/js/62.c76e37b0.js"><link rel="prefetch" href="/assets/js/63.4008c4ef.js"><link rel="prefetch" href="/assets/js/64.bec71ce5.js"><link rel="prefetch" href="/assets/js/65.3cb39de9.js"><link rel="prefetch" href="/assets/js/66.115241f4.js"><link rel="prefetch" href="/assets/js/67.bb894910.js"><link rel="prefetch" href="/assets/js/68.fc8308d7.js"><link rel="prefetch" href="/assets/js/69.ef0d5e14.js"><link rel="prefetch" href="/assets/js/7.be292676.js"><link rel="prefetch" href="/assets/js/70.b1075e65.js"><link rel="prefetch" href="/assets/js/71.5edb623b.js"><link rel="prefetch" href="/assets/js/72.361a9cc7.js"><link rel="prefetch" href="/assets/js/73.1c594548.js"><link rel="prefetch" href="/assets/js/74.5da73bd7.js"><link rel="prefetch" href="/assets/js/75.e48f86dc.js"><link rel="prefetch" href="/assets/js/76.7955ce92.js"><link rel="prefetch" href="/assets/js/77.a8560be9.js"><link rel="prefetch" href="/assets/js/78.ce9c434d.js"><link rel="prefetch" href="/assets/js/79.2be40b74.js"><link rel="prefetch" href="/assets/js/8.a3b721ba.js"><link rel="prefetch" href="/assets/js/80.83837b89.js"><link rel="prefetch" href="/assets/js/81.b265cdff.js"><link rel="prefetch" href="/assets/js/82.3067ad81.js"><link rel="prefetch" href="/assets/js/83.6005a55d.js"><link rel="prefetch" href="/assets/js/84.07138742.js"><link rel="prefetch" href="/assets/js/85.b02e7de9.js"><link rel="prefetch" href="/assets/js/86.b70aaa09.js"><link rel="prefetch" href="/assets/js/87.2b219850.js"><link rel="prefetch" href="/assets/js/88.c34dde5e.js"><link rel="prefetch" href="/assets/js/89.aab28daf.js"><link rel="prefetch" href="/assets/js/9.df5e2125.js"><link rel="prefetch" href="/assets/js/90.69fe422c.js"><link rel="prefetch" href="/assets/js/91.9d57fae3.js"><link rel="prefetch" href="/assets/js/92.3e94b6ed.js"><link rel="prefetch" href="/assets/js/93.8b009e29.js"><link rel="prefetch" href="/assets/js/94.87e464d9.js"><link rel="prefetch" href="/assets/js/95.4d41dade.js"><link rel="prefetch" href="/assets/js/96.035b722f.js"><link rel="prefetch" href="/assets/js/97.bf8bda85.js"><link rel="prefetch" href="/assets/js/98.655d930c.js"><link rel="prefetch" href="/assets/js/99.af1bad38.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3ff02ce1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">hsq</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JS/" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/Styles/" class="nav-link">
  Styles
</a></li><li class="dropdown-item"><h4>
          Browser
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BrowserModel/" class="nav-link">
  BrModel(MP)
</a></li><li class="dropdown-subitem"><a href="/Browser/" class="nav-link">
  RenderPr(MT)
</a></li></ul></li><li class="dropdown-item"><h4>
          React
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/React/" class="nav-link">
  ReactBase
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/" class="nav-link">
  VueBase
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/AlgorithmAI/" class="nav-link router-link-active">
  AI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/" class="nav-link">
  项目
</a></li><li class="dropdown-item"><h4>
          项目工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Tools/" class="nav-link">
  Git&amp;webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">Works</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">Works</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Interface/" class="nav-link">
  面经
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JS/" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/Styles/" class="nav-link">
  Styles
</a></li><li class="dropdown-item"><h4>
          Browser
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BrowserModel/" class="nav-link">
  BrModel(MP)
</a></li><li class="dropdown-subitem"><a href="/Browser/" class="nav-link">
  RenderPr(MT)
</a></li></ul></li><li class="dropdown-item"><h4>
          React
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/React/" class="nav-link">
  ReactBase
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/" class="nav-link">
  VueBase
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/AlgorithmAI/" class="nav-link router-link-active">
  AI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/" class="nav-link">
  项目
</a></li><li class="dropdown-item"><h4>
          项目工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Tools/" class="nav-link">
  Git&amp;webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webDesign" class="dropdown-title"><span class="title">Works</span> <span class="arrow down"></span></button> <button type="button" aria-label="webDesign" class="mobile-dropdown-title"><span class="title">Works</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Interface/" class="nav-link">
  面经
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Algorithm</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AlgorithmAI/likou/findLongth.html" class="sidebar-link">求最长递增子序列</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数学基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>机器学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AI</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pca的数学原理"><a href="#pca的数学原理" class="header-anchor">#</a> PCA的数学原理</h1> <p><a href="http://blog.codinglabs.org/" target="_blank" rel="noopener noreferrer">此文章为某算法博主的博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>PCA（Principal Component Analysis）是一种常用的数据分析方法。PCA通过线性变换将原始数据变换为一组各维度线性无关的表示，可用于提取数据的主要特征分量，常用于高维数据的降维。网上关于PCA的文章有很多，但是大多数只描述了PCA的分析过程，而没有讲述其中的原理。这篇文章的目的是介绍PCA的基本数学原理，帮助读者了解PCA的工作机制是什么。</p> <p>当然我并不打算把文章写成纯数学文章，而是希望用直观和易懂的方式叙述PCA的数学原理，所以整个文章不会引入严格的数学推导。希望读者在看完这篇文章后能更好的明白PCA的工作原理。</p> <p><font color="red">一般来说，主成分分析(Principal Components Analysis, PCA)适用于数据的线性降维。而核主成分分析(Kernel PCA, KPCA)可实现数据的非线性降维，用于处理线性不可分的数据集。</font></p> <h2 id="数据的向量表示及降维问题"><a href="#数据的向量表示及降维问题" class="header-anchor">#</a> 数据的向量表示及降维问题</h2> <p>一般情况下，在数据挖掘和机器学习中，数据被表示为向量。例如某个淘宝店2012年全年的流量及交易情况可以看成一组记录的集合，其中每一天的数据是一条记录，格式如下：</p> <p>(日期, 浏览量, 访客数, 下单数, 成交数, 成交金额)</p> <p>其中“日期”是一个记录标志而非度量值，而数据挖掘关心的大多是度量值，因此如果我们忽略日期这个字段后，我们得到一组记录，每条记录可以被表示为一个五维向量，其中一条看起来大约是这个样子：</p> <p>(500,240,25,13,2312.15)T(500,240,25,13,2312.15)T</p> <p>注意这里我用了转置，因为习惯上使用列向量表示一条记录（后面会看到原因），本文后面也会遵循这个准则。不过为了方便有时我会省略转置符号，但我们说到向量默认都是指列向量。</p> <p>我们当然可以对这一组五维向量进行分析和挖掘，不过我们知道，很多机器学习算法的复杂度和数据的维数有着密切关系，甚至与维数呈指数级关联。当然，这里区区五维的数据，也许还无所谓，但是实际机器学习中处理成千上万甚至几十万维的情况也并不罕见，在这种情况下，机器学习的资源消耗是不可接受的，因此我们必须对数据进行降维。</p> <p>降维当然意味着信息的丢失，不过鉴于实际数据本身常常存在的相关性，我们可以想办法在降维的同时将信息的损失尽量降低。</p> <p>举个例子，假如某学籍数据有两列M和F，其中M列的取值是如何此学生为男性取值1，为女性取值0；而F列是学生为女性取值1，男性取值0。此时如果我们统计全部学籍数据，会发现对于任何一条记录来说，当M为1时F必定为0，反之当M为0时F必定为1。在这种情况下，我们将M或F去掉实际上没有任何信息的损失，因为只要保留一列就可以完全还原另一列。</p> <p>当然上面是一个极端的情况，在现实中也许不会出现，不过类似的情况还是很常见的。例如上面淘宝店铺的数据，从经验我们可以知道，“浏览量”和“访客数”往往具有较强的相关关系，而“下单数”和“成交数”也具有较强的相关关系。这里我们非正式的使用“相关关系”这个词，可以直观理解为“当某一天这个店铺的浏览量较高（或较低）时，我们应该很大程度上认为这天的访客数也较高（或较低）”。后面的章节中我们会给出相关性的严格数学定义。</p> <p>这种情况表明，如果我们删除浏览量或访客数其中一个指标，我们应该期待并不会丢失太多信息。因此我们可以删除一个，以降低机器学习算法的复杂度。</p> <p>上面给出的是降维的朴素思想描述，可以有助于直观理解降维的动机和可行性，但并不具有操作指导意义。例如，我们到底删除哪一列损失的信息才最小？亦或根本不是单纯删除几列，而是通过某些变换将原始数据变为更少的列但又使得丢失的信息最小？到底如何度量丢失信息的多少？如何根据原始数据决定具体的降维操作步骤？</p> <p>要回答上面的问题，就要对降维问题进行数学化和形式化的讨论。而PCA是一种具有严格数学基础并且已被广泛采用的降维方法。下面我不会直接描述PCA，而是通过逐步分析问题，让我们一起重新“发明”一遍PCA。</p> <h2 id="向量的表示及基变换"><a href="#向量的表示及基变换" class="header-anchor">#</a> 向量的表示及基变换</h2> <p>既然我们面对的数据被抽象为一组向量，那么下面有必要研究一些向量的数学性质。而这些数学性质将成为后续导出PCA的理论基础。</p> <h3 id="内积与投影"><a href="#内积与投影" class="header-anchor">#</a> 内积与投影</h3> <p>下面先来看一个高中就学过的向量运算：内积。两个维数相同的向量的内积被定义为：</p> <p>(a1,a2,⋯,an)T⋅(b1,b2,⋯,bn)T=a1b1+a2b2+⋯+anbn(a1,a2,⋯,an)T⋅(b1,b2,⋯,bn)T=a1b1+a2b2+⋯+anbn</p> <p>内积运算将两个向量映射为一个实数。其计算方式非常容易理解，但是其意义并不明显。下面我们分析内积的几何意义。假设A和B是两个n维向量，我们知道n维向量可以等价表示为n维空间中的一条从原点发射的有向线段，为了简单起见我们假设A和B均为二维向量，则A=(x1,y1)A=(x1,y1)，B=(x2,y2)B=(x2,y2)。则在二维平面上A和B可以用两条发自原点的有向线段表示，见下图：</p> <p><img src="mathOfPCA.assets/01.png" alt="img"></p> <p>好，现在我们从A点向B所在直线引一条垂线。我们知道垂线与B的交点叫做A在B上的投影，再设A与B的夹角是a，则投影的矢量长度为|A|cos(a)|A|cos(a)，其中|A|=x21+y21−−−−−−√|A|=x12+y12是向量A的模，也就是A线段的标量长度。</p> <p>注意这里我们专门区分了矢量长度和标量长度，标量长度总是大于等于0，值就是线段的长度；而矢量长度可能为负，其绝对值是线段长度，而符号取决于其方向与标准方向相同或相反。</p> <p>到这里还是看不出内积和这东西有什么关系，不过如果我们将内积表示为另一种我们熟悉的形式：</p> <p>A⋅B=|A||B|cos(a)A⋅B=|A||B|cos(a)</p> <p>现在事情似乎是有点眉目了：A与B的内积等于A到B的投影长度乘以B的模。再进一步，如果我们假设B的模为1，即让|B|=1|B|=1，那么就变成了：</p> <p>A⋅B=|A|cos(a)A⋅B=|A|cos(a)</p> <p>也就是说，<strong>设向量B的模为1，则A与B的内积值等于A向B所在直线投影的矢量长度</strong>！这就是内积的一种几何解释，也是我们得到的第一个重要结论。在后面的推导中，将反复使用这个结论。</p> <h3 id="基"><a href="#基" class="header-anchor">#</a> 基</h3> <p>下面我们继续在二维空间内讨论向量。上文说过，一个二维向量可以对应二维笛卡尔直角坐标系中从原点出发的一个有向线段。例如下面这个向量：</p> <p><img src="mathOfPCA.assets/02.png" alt="img"></p> <p>在代数表示方面，我们经常用线段终点的点坐标表示向量，例如上面的向量可以表示为(3,2)，这是我们再熟悉不过的向量表示。</p> <p>不过我们常常忽略，<strong>只有一个(3,2)本身是不能够精确表示一个向量的</strong>。我们仔细看一下，这里的3实际表示的是向量在x轴上的投影值是3，在y轴上的投影值是2。也就是说我们其实隐式引入了一个定义：以x轴和y轴上正方向长度为1的向量为标准。那么一个向量(3,2)实际是说在x轴投影为3而y轴的投影为2。注意投影是一个矢量，所以可以为负。</p> <p>更正式的说，向量(x,y)实际上表示线性组合：</p> <p>x(1,0)T+y(0,1)Tx(1,0)T+y(0,1)T</p> <p>不难证明所有二维向量都可以表示为这样的线性组合。此处(1,0)和(0,1)叫做二维空间中的一组基。</p> <p><img src="mathOfPCA.assets/03.png" alt="img"></p> <p>所以，<strong>要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了</strong>。只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。</p> <p>我们之所以默认选择(1,0)和(0,1)为基，当然是比较方便，因为它们分别是x和y轴正方向上的单位向量，因此就使得二维平面上点坐标和向量一一对应，非常方便。但实际上任何两个线性无关的二维向量都可以成为一组基，所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。</p> <p>例如，(1,1)和(-1,1)也可以成为一组基。一般来说，我们希望基的模是1，因为从内积的意义可以看到，如果基的模是1，那么就可以方便的用向量点乘基而直接获得其在新基上的坐标了！实际上，对应任何一个向量我们总可以找到其同方向上模为1的向量，只要让两个分量分别除以模就好了。例如，上面的基可以变为(12√,12√)(12,12)和(−12√,12√)(−12,12)。</p> <p>现在，我们想获得(3,2)在新基上的坐标，即在两个方向上的投影矢量值，那么根据内积的几何意义，我们只要分别计算(3,2)和两个基的内积，不难得到新的坐标为(52√,−12√)(52,−12)。下图给出了新的基以及(3,2)在新基上坐标值的示意图：</p> <p><img src="mathOfPCA.assets/05.png" alt="img"></p> <p>另外这里要注意的是，我们列举的例子中基是正交的（即内积为0，或直观说相互垂直），但可以成为一组基的唯一要求就是线性无关，非正交的基也是可以的。不过因为正交基有较好的性质，所以一般使用的基都是正交的。</p> <h3 id="基变换的矩阵表示"><a href="#基变换的矩阵表示" class="header-anchor">#</a> 基变换的矩阵表示</h3> <p>下面我们找一种简便的方式来表示基变换。还是拿上面的例子，想一下，将(3,2)变换为新基上的坐标，就是用(3,2)与第一个基做内积运算，作为第一个新的坐标分量，然后用(3,2)与第二个基做内积运算，作为第二个新坐标的分量。实际上，我们可以用矩阵相乘的形式简洁的表示这个变换：</p> <p>(1/2–√−1/2–√1/2–√1/2–√)(32)=(5/2–√−1/2–√)(1/21/2−1/21/2)(32)=(5/2−1/2)</p> <p>太漂亮了！其中矩阵的两行分别为两个基，乘以原向量，其结果刚好为新基的坐标。可以稍微推广一下，如果我们有m个二维向量，只要将二维向量按列排成一个两行m列矩阵，然后用“基矩阵”乘以这个矩阵，就得到了所有这些向量在新基下的值。例如(1,1)，(2,2)，(3,3)，想变换到刚才那组基上，则可以这样表示：</p> <p>(1/2–√−1/2–√1/2–√1/2–√)(112233)=(2/2–√04/2–√06/2–√0)(1/21/2−1/21/2)(123123)=(2/24/26/2000)</p> <p>于是一组向量的基变换被干净的表示为矩阵的相乘。</p> <p><strong>一般的，如果我们有M个N维向量，想将其变换为由R个N维向量表示的新空间中，那么首先将R个基按行组成矩阵A，然后将向量按列组成矩阵B，那么两矩阵的乘积AB就是变换结果，其中AB的第m列为A中第m列变换后的结果</strong>。</p> <p>数学表示为：</p> <p>⎛⎝⎜⎜⎜⎜p1p2⋮pR⎞⎠⎟⎟⎟⎟(a1a2⋯aM)=⎛⎝⎜⎜⎜⎜⎜p1a1p2a1⋮pRa1p1a2p2a2⋮pRa2⋯⋯⋱⋯p1aMp2aM⋮pRaM⎞⎠⎟⎟⎟⎟⎟(p1p2⋮pR)(a1a2⋯aM)=(p1a1p1a2⋯p1aMp2a1p2a2⋯p2aM⋮⋮⋱⋮pRa1pRa2⋯pRaM)</p> <p>其中pipi是一个行向量，表示第i个基，ajaj是一个列向量，表示第j个原始数据记录。</p> <p>特别要注意的是，这里R可以小于N，而R决定了变换后数据的维数。也就是说，我们可以将一N维数据变换到更低维度的空间中去，变换后的维度取决于基的数量。因此这种矩阵相乘的表示也可以表示降维变换。</p> <p>最后，上述分析同时给矩阵相乘找到了一种物理解释：<strong>两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去</strong>。更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。</p> <h2 id="协方差矩阵及优化目标"><a href="#协方差矩阵及优化目标" class="header-anchor">#</a> 协方差矩阵及优化目标</h2> <p>上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？</p> <p>要完全数学化这个问题非常繁杂，这里我们用一种非形式化的直观方法来看这个问题。</p> <p>为了避免过于抽象的讨论，我们仍以一个具体的例子展开。假设我们的数据由五条记录组成，将它们表示成矩阵形式：</p> <p>(1113234424)(1124213344)</p> <p>其中每一列为一条数据记录，而一行为一个字段。为了后续处理方便，我们首先将每个字段内所有值都减去字段均值，其结果是将每个字段都变为均值为0（这样做的道理和好处后面会看到）。</p> <p>我们看上面的数据，第一个字段均值为2，第二个字段均值为3，所以变换后：</p> <p>(−1−2−10002101)(−1−1020−20011)</p> <p>我们可以看下五条数据在平面直角坐标系内的样子：</p> <p><img src="mathOfPCA.assets/06.png" alt="img"></p> <p>现在问题来了：如果我们必须使用一维来表示这些数据，又希望尽量保留原始的信息，你要如何选择？</p> <p>通过上一节对基变换的讨论我们知道，这个问题实际上是要在二维平面中选择一个方向，将所有数据都投影到这个方向所在直线上，用投影值表示原始记录。这是一个实际的二维降到一维的问题。</p> <p>那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。</p> <p>以上图为例，可以看出如果向x轴投影，那么最左边的两个点会重叠在一起，中间的两个点也会重叠在一起，于是本身四个各不相同的二维点投影后只剩下两个不同的值了，这是一种严重的信息丢失，同理，如果向y轴投影最上面的两个点和分布在x轴上的两个点也会重叠。所以看来x和y轴都不是最好的投影选择。我们直观目测，如果向通过第一象限和第三象限的斜线投影，则五个点在投影后还是可以区分的。</p> <p>下面，我们用数学方法表述这个问题。</p> <h3 id="方差"><a href="#方差" class="header-anchor">#</a> 方差</h3> <p>上文说到，我们希望投影后投影值尽可能分散，而这种分散程度，可以用数学上的方差来表述。此处，一个字段的方差可以看做是每个元素与字段均值的差的平方和的均值，即：</p> <p>Var(a)=1m∑i=1m(ai−μ)2Var(a)=1m∑i=1m(ai−μ)2</p> <p>由于上面我们已经将每个字段的均值都化为0了，因此方差可以直接用每个元素的平方和除以元素个数表示：</p> <p>Var(a)=1m∑i=1ma2iVar(a)=1m∑i=1mai2</p> <p>于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，方差值最大。</p> <h3 id="协方差"><a href="#协方差" class="header-anchor">#</a> 协方差</h3> <p>对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。</p> <p>如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。</p> <p>数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：</p> <p>Cov(a,b)=1m∑i=1maibiCov(a,b)=1m∑i=1maibi</p> <p>可以看到，在字段均值为0的情况下，两个字段的协方差简洁的表示为其内积除以元素数m。</p> <p>当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择。因此最终选择的两个方向一定是正交的。</p> <p>至此，我们得到了降维问题的优化目标：<strong>将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）</strong>。</p> <h3 id="协方差矩阵"><a href="#协方差矩阵" class="header-anchor">#</a> 协方差矩阵</h3> <p>上面我们导出了优化目标，但是这个目标似乎不能直接作为操作指南（或者说算法），因为它只说要什么，但根本没有说怎么做。所以我们要继续在数学上研究计算方案。</p> <p>我们看到，最终要达到的目的与字段内方差及字段间协方差有密切关系。因此我们希望能将两者统一表示，仔细观察发现，两者均可以表示为内积的形式，而内积又与矩阵相乘密切相关。于是我们来了灵感：</p> <p>假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：</p> <p>X=(a1b1a2b2⋯⋯ambm)X=(a1a2⋯amb1b2⋯bm)</p> <p>然后我们用X乘以X的转置，并乘上系数1/m：</p> <p>1mXXT=(1m∑mi=1a2i1m∑mi=1aibi1m∑mi=1aibi1m∑mi=1b2i)1mXXT=(1m∑i=1mai21m∑i=1maibi1m∑i=1maibi1m∑i=1mbi2)</p> <p>奇迹出现了！这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。两者被统一到了一个矩阵的。</p> <p>根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：</p> <p><strong>设我们有m个n维数据记录，将其按列排成n乘m的矩阵X，设C=1mXXTC=1mXXT，则C是一个对称矩阵，其对角线分别个各个字段的方差，而第i行j列和j行i列元素相同，表示i和j两个字段的协方差</strong>。</p> <h3 id="协方差矩阵对角化"><a href="#协方差矩阵对角化" class="header-anchor">#</a> 协方差矩阵对角化</h3> <p>根据上述推导，我们发现要达到优化目前，等价于将协方差矩阵对角化：即除对角线外的其它元素化为0，并且在对角线上将元素按大小从上到下排列，这样我们就达到了优化目的。这样说可能还不是很明晰，我们进一步看下原矩阵与基变换后矩阵协方差矩阵的关系：</p> <p>设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，我们推导一下D与C的关系：</p> <p>D=====1mYYT1m(PX)(PX)T1mPXXTPTP(1mXXT)PTPCPTD=1mYYT=1m(PX)(PX)T=1mPXXTPT=P(1mXXT)PT=PCPT</p> <p>现在事情很明白了！我们要找的P不是别的，而是能让原始协方差矩阵对角化的P。换句话说，优化目标变成了<strong>寻找一个矩阵P，满足PCPTPCPT是一个对角矩阵，并且对角元素按从大到小依次排列，那么P的前K行就是要寻找的基，用P的前K行组成的矩阵乘以X就使得X从N维降到了K维并满足上述优化条件</strong>。</p> <p>至此，我们离“发明”PCA还有仅一步之遥！</p> <p>现在所有焦点都聚焦在了协方差矩阵对角化问题上，有时，我们真应该感谢数学家的先行，因为矩阵对角化在线性代数领域已经属于被玩烂了的东西，所以这在数学上根本不是问题。</p> <p>由上文知道，协方差矩阵C是一个是对称矩阵，在线性代数上，实对称矩阵有一系列非常好的性质：</p> <p>1）实对称矩阵不同特征值对应的特征向量必然正交。</p> <p>2）设特征向量λλ重数为r，则必然存在r个线性无关的特征向量对应于λλ，因此可以将这r个特征向量单位正交化。</p> <p>由上面两条可知，一个n行n列的实对称矩阵一定可以找到n个单位正交特征向量，设这n个特征向量为e1,e2,⋯,ene1,e2,⋯,en，我们将其按列组成矩阵：</p> <p>E=(e1e2⋯en)E=(e1e2⋯en)</p> <p>则对协方差矩阵C有如下结论：</p> <p>ETCE=Λ=⎛⎝⎜⎜⎜⎜⎜λ1λ2⋱λn⎞⎠⎟⎟⎟⎟⎟ETCE=Λ=(λ1λ2⋱λn)</p> <p>其中ΛΛ为对角矩阵，其对角元素为各特征向量对应的特征值（可能有重复）。</p> <p>以上结论不再给出严格的数学证明，对证明感兴趣的朋友可以参考线性代数书籍关于“实对称矩阵对角化”的内容。</p> <p>到这里，我们发现我们已经找到了需要的矩阵P：</p> <p>P=ETP=ET</p> <p>P是协方差矩阵的特征向量单位化后按行排列出的矩阵，其中每一行都是C的一个特征向量。如果设P按照ΛΛ中特征值的从大到小，将特征向量从上到下排列，则用P的前K行组成的矩阵乘以原始数据矩阵X，就得到了我们需要的降维后的数据矩阵Y。</p> <p>至此我们完成了整个PCA的数学原理讨论。在下面的一节，我们将给出PCA的一个实例。</p> <h2 id="算法及实例"><a href="#算法及实例" class="header-anchor">#</a> 算法及实例</h2> <p>为了巩固上面的理论，我们在这一节给出一个具体的PCA实例。</p> <h3 id="pca算法"><a href="#pca算法" class="header-anchor">#</a> PCA算法</h3> <p>总结一下PCA的算法步骤：</p> <p>设有m条n维数据。</p> <p>1）将原始数据按列组成n行m列矩阵X</p> <p>2）将X的每一行（代表一个属性字段）进行零均值化，即减去这一行的均值</p> <p>3）求出协方差矩阵C=1mXXTC=1mXXT</p> <p>4）求出协方差矩阵的特征值及对应的特征向量</p> <p>5）将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P</p> <p>6）Y=PXY=PX即为降维到k维后的数据</p> <h3 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h3> <p>这里以上文提到的</p> <p>(−1−2−10002101)(−1−1020−20011)</p> <p>为例，我们用PCA方法将这组二维数据其降到一维。</p> <p>因为这个矩阵的每行已经是零均值，这里我们直接求协方差矩阵：</p> <p>C=15(−1−2−10002101)⎛⎝⎜⎜⎜⎜⎜⎜−1−1020−20011⎞⎠⎟⎟⎟⎟⎟⎟=(65454565)C=15(−1−1020−20011)(−1−2−10002101)=(65454565)</p> <p>然后求其特征值和特征向量，具体求解方法不再详述，可以参考相关资料。求解后特征值为：</p> <p>λ1=2,λ2=2/5λ1=2,λ2=2/5</p> <p>其对应的特征向量分别是：</p> <p>c1(11),c2(−11)c1(11),c2(−11)</p> <p>其中对应的特征向量分别是一个通解，c1c1和c2c2可取任意实数。那么标准化后的特征向量为：</p> <p>(1/2–√1/2–√),(−1/2–√1/2–√)(1/21/2),(−1/21/2)</p> <p>因此我们的矩阵P是：</p> <p>P=(1/2–√−1/2–√1/2–√1/2–√)P=(1/21/2−1/21/2)</p> <p>可以验证协方差矩阵C的对角化：</p> <p>PCPT=(1/2–√−1/2–√1/2–√1/2–√)(6/54/54/56/5)(1/2–√1/2–√−1/2–√1/2–√)=(2002/5)PCPT=(1/21/2−1/21/2)(6/54/54/56/5)(1/2−1/21/21/2)=(2002/5)</p> <p>最后我们用P的第一行乘以数据矩阵，就得到了降维后的表示：</p> <p>Y=(1/2–√1/2–√)(−1−2−10002101)=(−3/2–√−1/2–√03/2–√−1/2–√)Y=(1/21/2)(−1−1020−20011)=(−3/2−1/203/2−1/2)</p> <p>降维投影结果如下图：</p> <p><img src="mathOfPCA.assets/07.png" alt="img"></p> <h2 id="进一步讨论"><a href="#进一步讨论" class="header-anchor">#</a> 进一步讨论</h2> <p>根据上面对PCA的数学原理的解释，我们可以了解到一些PCA的能力和限制。PCA本质上是将方差最大的方向作为主要特征，并且在各个正交方向上将数据“离相关”，也就是让它们在不同正交方向上没有相关性。</p> <p>因此，PCA也存在一些限制，例如它可以很好的解除线性相关，但是对于高阶相关性就没有办法了，对于存在高阶相关性的数据，可以考虑Kernel PCA，通过Kernel函数将非线性相关转为线性相关，关于这点就不展开讨论了。另外，PCA假设数据各主特征是分布在正交方向上，如果在非正交方向上存在几个方差较大的方向，PCA的效果就大打折扣了。</p> <p>最后需要说明的是，PCA是一种无参数技术，也就是说面对同样的数据，如果不考虑清洗，谁来做结果都一样，没有主观参数的介入，所以PCA便于通用实现，但是本身无法个性化的优化。</p> <p>希望这篇文章能帮助朋友们了解PCA的数学理论基础和实现原理，借此了解PCA的适用场景和限制，从而更好的使用这个算法。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/19/2021, 9:19:30 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a8893540.js" defer></script><script src="/assets/js/2.31cb5988.js" defer></script><script src="/assets/js/13.ab04a391.js" defer></script>
  </body>
</html>
